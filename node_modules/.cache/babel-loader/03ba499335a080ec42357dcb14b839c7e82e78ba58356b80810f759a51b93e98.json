{"ast":null,"code":"var _jsxFileName = \"D:\\\\Book Talk\\\\client\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useState } from \"react\";\nimport useLocalStorage from \"../custom-hooks/hook-localStorage/useLocalStorage\";\nimport { AUTH_DATA_STORAGE } from \"../api/api\";\nimport * as authServices from \"../services/authServices\";\nimport { useNavigate } from \"react-router-dom\";\nimport useGetAllUsers from \"../custom-hooks/hooks-requests/useGetAllUsers\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nconst AuthContextProvider = props => {\n  _s();\n  const [state, setState] = useLocalStorage(AUTH_DATA_STORAGE, []);\n  const [users, setUsers] = useGetAllUsers([]);\n  const [serverError, setServerError] = useState(null);\n  const navigate = useNavigate();\n  async function userRegister(user) {\n    const allUsers = await authServices.getAllUsers();\n    const existingEmail = allUsers.find(x => x.email === user.email);\n    if (existingEmail) {\n      setServerError(\"Email is alredy taken...\");\n      return serverError;\n    }\n    const existingUsername = allUsers.find(x => x.username === user.username);\n    if (existingUsername) {\n      setServerError(\"Username is alredy taken...\");\n      return serverError;\n    }\n    await authServices.register(user);\n    setState(user);\n    navigate('/');\n  }\n  async function userLogin(user) {\n    const allUsers = await authServices.getAllUsers();\n    if (allUsers.length === 0) {\n      setServerError(\"Email or password don't match...\");\n      return serverError;\n    } else {\n      const existingUser = allUsers.find(x => x.email === user.email);\n      if (existingUser === undefined) {\n        setServerError(\"Email or password don't match...\");\n        return serverError;\n      }\n      if (existingUser.password !== user.password) {\n        setServerError(\"Email or password don't match...\");\n        return serverError;\n      }\n      setState(existingUser);\n      navigate('/');\n    }\n  }\n  function userLogout() {\n    navigate('/login');\n    setState({});\n    localStorage.clear(AUTH_DATA_STORAGE);\n  }\n  async function updateUser(userId, user) {\n    const result = await authServices.update(userId, user);\n    setUsers(users.map(x => x.id === userId ? result : x));\n    navigate('');\n  }\n  async function addWishReadBooks(book) {}\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user: state,\n      users,\n      serverError,\n      userRegister,\n      userLogin,\n      updateUser,\n      userLogout\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthContextProvider, \"++muAcB3t3ZYwYLAOWbG/LpwVuQ=\", false, function () {\n  return [useLocalStorage, useGetAllUsers, useNavigate];\n});\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useState","useLocalStorage","AUTH_DATA_STORAGE","authServices","useNavigate","useGetAllUsers","jsxDEV","_jsxDEV","AuthContext","AuthContextProvider","props","_s","state","setState","users","setUsers","serverError","setServerError","navigate","userRegister","user","allUsers","getAllUsers","existingEmail","find","x","email","existingUsername","username","register","userLogin","length","existingUser","undefined","password","userLogout","localStorage","clear","updateUser","userId","result","update","map","id","addWishReadBooks","book","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/Book Talk/client/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useState } from \"react\";\r\nimport useLocalStorage from \"../custom-hooks/hook-localStorage/useLocalStorage\";\r\nimport { AUTH_DATA_STORAGE } from \"../api/api\";\r\nimport * as authServices from \"../services/authServices\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport useGetAllUsers from \"../custom-hooks/hooks-requests/useGetAllUsers\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nconst AuthContextProvider = (props) => {\r\n\r\n    const [state, setState] = useLocalStorage(AUTH_DATA_STORAGE, []);\r\n    const [users, setUsers] = useGetAllUsers([]);\r\n    const [serverError, setServerError] = useState(null);\r\n    const navigate = useNavigate();\r\n\r\n\r\n\r\n    async function userRegister(user) {\r\n        const allUsers = await authServices.getAllUsers();\r\n        const existingEmail = allUsers.find(x => x.email === user.email);\r\n\r\n        if (existingEmail) {\r\n            setServerError(\"Email is alredy taken...\");\r\n            return serverError;\r\n        }\r\n\r\n        const existingUsername = allUsers.find(x => x.username === user.username);\r\n        if (existingUsername) {\r\n            setServerError(\"Username is alredy taken...\");\r\n            return serverError;\r\n        }\r\n\r\n        await authServices.register(user)\r\n        setState(user);\r\n        navigate('/');\r\n\r\n    }\r\n\r\n    async function userLogin(user) {\r\n        const allUsers = await authServices.getAllUsers();\r\n        if (allUsers.length === 0) {\r\n            setServerError(\"Email or password don't match...\");\r\n            return serverError;\r\n        } else {\r\n            const existingUser = allUsers.find(x => x.email === user.email);\r\n            if (existingUser === undefined) {\r\n                setServerError(\"Email or password don't match...\");\r\n                return serverError;\r\n            }\r\n\r\n            if (existingUser.password !== user.password) {\r\n                setServerError(\"Email or password don't match...\");\r\n                return serverError;\r\n            }\r\n\r\n            setState(existingUser);\r\n            navigate('/');\r\n        }\r\n    }\r\n\r\n\r\n    function userLogout() {\r\n        navigate('/login')\r\n        setState({});\r\n        localStorage.clear(AUTH_DATA_STORAGE);\r\n    }\r\n\r\n    async function updateUser(userId, user) {\r\n       const result = await authServices.update(userId, user);\r\n       setUsers(users.map(x => x.id === userId ? result : x));\r\n       navigate('')\r\n    }\r\n\r\n    async function addWishReadBooks(book) {\r\n\r\n    }\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            user: state,\r\n            users,\r\n            serverError,\r\n            userRegister,\r\n            userLogin,\r\n            updateUser,\r\n            userLogout\r\n        }}>\r\n            {props.children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\n\r\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}